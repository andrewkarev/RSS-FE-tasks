!function(){"use strict";var n={carsBrands:["Tesla","Aston Martin","Rolls-Royce","Ferrari","Lamborghini","Porsche","Maserati","Ford","Mercedes","Audi"],carsModels:["Model S","DBS","Phantom (VII)","Roma","huracan","Carrera GT","GranTurismo","Mustang Shelby GT 500","AMG GT","R8"],carsInGarage:0,winnersAtAll:0,carsPerPageLimit:7,winnersPerPageLimit:10,selectedCarId:0,currentGaragePage:1,currentWinnersPage:1,currentPage:"garage",carsAnimationId:{},carsOnPage:[],raceWinnerId:0,isRace:!1,paginationButtonsState:{prevIsActive:!1,nextIsActive:!1},sortBy:"time",order:"ASC",winsOrder:"ASC",timeOrder:"ASC"},t=function(n,t,e,o){return new(e||(e=Promise))((function(a,r){function i(n){try{d(o.next(n))}catch(n){r(n)}}function c(n){try{d(o.throw(n))}catch(n){r(n)}}function d(n){var t;n.done?a(n.value):(t=n.value,t instanceof e?t:new e((function(n){n(t)}))).then(i,c)}d((o=o.apply(n,t||[])).next())}))};const e="http://localhost:3000",o=`${e}/garage`,a=`${e}/engine`,r=`${e}/winners`,i=n=>t(void 0,void 0,void 0,(function*(){try{const t=yield fetch(`${a}?id=${n}&status=stopped`,{method:"PATCH"}),e=yield t.json();if(200===t.status)return e}catch(n){if(n instanceof Error)throw new Error(n.message)}return null})),c=n=>t(void 0,void 0,void 0,(function*(){try{const t=yield fetch(`${a}?id=${n}&status=drive`,{method:"PATCH"});return 200===t.status?yield t.json():{success:!1}}catch(n){if(n instanceof Error)throw new Error(n.message)}return null})),d=(n,e,o,a=10)=>t(void 0,void 0,void 0,(function*(){try{const t=yield fetch(`${r}?_page=${n}&_limit=${a}&_sort=${e}&_order=${o}`),i=yield t.json(),c=t.headers.get("X-Total-Count"),d=Number(c);if(200===t.status)return{winners:i,count:d}}catch(n){if(n instanceof Error)throw new Error(n.message)}return null})),s=n=>`\n  <svg version="1.0" xmlns="http://www.w3.org/2000/svg" width="84" height="42"\n  viewBox="0 0 1280.000000 640.000000" preserveAspectRatio="xMidYMid meet">\n  <metadata>\n    Created by potrace 1.15, written by Peter Selinger 2001-2017\n  </metadata>\n  <g transform="translate(0.000000,640.000000) scale(0.100000,-0.100000)" fill="${n}" stroke="none">\n    <path d="M3565 5336 c-106 -30 -101 -26 -108 -111 -4 -42 -9 -80 -12 -85 -6\n      -10 -246 -105 -590 -234 -448 -167 -1052 -415 -1173 -483 -78 -43 -193 -91\n      -250 -104 -23 -5 -98 -14 -165 -19 -67 -6 -167 -19 -222 -30 -154 -31 -340\n      -49 -563 -57 l-203 -6 -43 -66 c-59 -91 -60 -95 -26 -130 37 -37 38 -65 3\n      -150 -25 -62 -27 -78 -31 -256 l-4 -190 -38 -32 c-91 -78 -133 -209 -134 -418\n      0 -194 11 -396 26 -482 13 -71 14 -74 72 -122 69 -58 130 -129 158 -184 64\n      -126 534 -211 1384 -250 l92 -4 -6 119 c-6 142 8 256 49 383 112 352 394 622\n      756 722 90 26 112 28 278 28 165 0 188 -2 278 -27 201 -56 361 -152 504 -302\n      140 -145 222 -293 274 -492 21 -79 24 -109 23 -279 -1 -127 -6 -214 -16 -263\n      l-15 -73 3006 7 c1653 4 3007 8 3009 9 1 1 -8 37 -20 81 -19 67 -22 105 -22\n      259 -1 166 1 187 27 279 117 421 467 736 885 797 119 17 325 7 432 -21 239\n      -63 453 -205 601 -399 70 -92 154 -267 185 -386 24 -88 27 -119 27 -260 1\n      -116 -4 -181 -16 -234 -10 -41 -16 -75 -15 -76 2 -1 62 2 133 6 266 16 458 45\n      525 79 48 24 97 81 127 146 l24 52 -16 157 c-15 152 -15 163 4 284 63 388 50\n      680 -35 802 -134 193 -526 336 -1429 519 -737 149 -1322 209 -2033 210 -228 0\n      -226 0 -347 85 -187 131 -1045 607 -1471 815 -383 187 -788 281 -1439 332\n      -208 17 -1106 16 -1400 0 -121 -7 -314 -19 -430 -27 -302 -22 -286 -22 -341\n      10 -140 81 -187 94 -269 71z m1885 -333 c6 -37 38 -238 71 -446 32 -209 66\n      -422 75 -474 9 -52 15 -96 13 -97 -11 -9 -1699 29 -1951 44 -206 13 -417 36\n      -485 54 -98 26 -198 119 -249 231 -35 75 -36 172 -5 255 17 45 30 61 68 86 83\n      54 135 80 253 127 341 136 858 230 1460 267 269 16 270 16 511 18 l227 2 12\n      -67z m630 47 c264 -18 777 -110 1029 -186 186 -56 445 -188 756 -387 211 -134\n      274 -181 250 -185 -75 -12 -133 -50 -162 -106 -19 -35 -21 -136 -4 -179 l11\n      -27 -907 2 -906 3 -59 160 c-110 302 -298 878 -298 916 0 6 95 2 290 -11z" />\n    <path d="M2633 3125 c-223 -40 -410 -141 -568 -306 -132 -138 -213 -283 -262\n      -467 -22 -83 -26 -119 -26 -247 -1 -169 10 -236 65 -382 87 -230 271 -436 493\n      -551 85 -44 178 -78 271 -98 107 -23 312 -23 419 1 392 84 699 375 802 761 23\n      86 26 120 27 254 1 158 -5 199 -46 330 -98 310 -355 567 -668 669 -150 50\n      -354 64 -507 36z m350 -301 c249 -56 457 -247 543 -499 25 -72 28 -95 28 -220\n      1 -153 -15 -228 -74 -345 -94 -186 -283 -337 -485 -386 -96 -24 -268 -24 -360\n      0 -320 84 -544 355 -562 681 -20 359 209 673 558 765 94 24 253 26 352 4z" />\n    <path d="M2600 2697 c-36 -13 -85 -36 -109 -51 l-44 -28 116 -115 c81 -82 120\n      -114 131 -110 14 6 16 29 16 167 0 186 6 178 -110 137z" />\n    <path d="M2920 2561 c0 -139 2 -162 16 -168 11 -4 50 28 130 108 l115 114 -28\n      22 c-34 28 -138 70 -193 79 l-40 7 0 -162z" />\n    <path d="M2282 2448 c-28 -36 -92 -191 -92 -225 0 -10 34 -13 165 -13 151 0\n      165 1 165 18 0 15 -206 232 -221 232 -4 0 -11 -6 -17 -12z" />\n    <path d="M3222 2351 c-62 -59 -112 -115 -112 -124 0 -15 17 -17 165 -17 131 0\n      165 3 165 13 0 40 -69 205 -95 227 -7 6 -48 -27 -123 -99z" />\n    <path d="M2781 2332 c-12 -22 11 -62 34 -62 8 0 21 10 29 22 20 28 4 58 -29\n      58 -13 0 -29 -8 -34 -18z" />\n    <path d="M2749 2161 c-32 -33 -37 -67 -14 -110 29 -57 104 -64 151 -14 53 57\n      9 153 -71 153 -27 0 -44 -8 -66 -29z" />\n    <path d="M2570 2125 c-26 -32 13 -81 48 -59 24 16 27 45 6 61 -23 17 -39 16\n      -54 -2z" />\n    <path d="M3006 2124 c-20 -19 -20 -38 -2 -54 23 -19 61 -8 64 18 7 44 -32 67\n      -62 36z" />\n    <path d="M2190 1975 c0 -29 41 -140 72 -194 l31 -53 117 117 c71 71 116 123\n      113 131 -4 11 -40 14 -169 14 -141 0 -164 -2 -164 -15z" />\n    <path d="M3110 1972 c0 -9 51 -68 114 -131 l114 -114 31 54 c30 51 71 165 71\n      195 0 11 -31 14 -165 14 -151 0 -165 -1 -165 -18z" />\n    <path d="M2780 1901 c-7 -15 -5 -24 8 -41 32 -40 85 -4 62 41 -14 25 -56 25\n      -70 0z" />\n    <path d="M2562 1697 c-61 -62 -112 -115 -112 -119 0 -18 208 -108 249 -108 7\n      0 11 54 11 164 0 140 -2 165 -16 170 -9 3 -16 6 -17 6 -1 0 -53 -51 -115 -113z" />\n    <path d="M2933 1803 c-15 -6 -19 -333 -4 -333 46 0 251 88 251 108 0 9 -223\n      232 -230 231 -3 0 -11 -3 -17 -6z" />\n    <path d="M10700 3119 c-390 -84 -696 -376 -797 -759 -31 -117 -41 -292 -24\n      -411 33 -227 150 -453 318 -609 267 -250 643 -344 993 -249 117 32 283 118\n      380 196 487 396 518 1128 67 1560 -97 93 -166 140 -290 198 -137 64 -235 86\n      -407 91 -120 3 -162 0 -240 -17z m445 -313 c238 -81 409 -258 486 -506 30 -96\n      33 -289 5 -388 -110 -400 -513 -637 -911 -536 -149 38 -313 147 -402 267 -176\n      238 -203 533 -71 797 34 69 60 103 138 180 77 78 111 104 181 139 129 65 207\n      81 364 77 109 -3 143 -7 210 -30z" />\n    <path d="M10703 2700 c-54 -19 -153 -71 -153 -80 0 -3 51 -57 114 -119 80 -80\n      119 -112 130 -108 14 5 16 29 16 167 l0 160 -27 -1 c-16 0 -52 -9 -80 -19z" />\n    <path d="M11020 2561 c0 -139 2 -162 16 -168 22 -8 247 216 234 232 -17 20\n      -163 84 -207 91 l-43 7 0 -162z" />\n    <path d="M10366 2424 c-29 -44 -76 -165 -76 -194 0 -19 7 -20 165 -20 126 0\n      165 3 165 13 0 7 -51 63 -114 126 l-114 114 -26 -39z" />\n    <path d="M11313 2348 c-61 -62 -109 -119 -106 -125 6 -15 333 -19 333 -4 0 45\n      -88 241 -108 241 -4 0 -57 -51 -119 -112z" />\n    <path d="M10882 2338 c-17 -17 -15 -32 7 -52 16 -14 23 -15 41 -6 31 17 24 64\n      -10 68 -14 2 -31 -3 -38 -10z" />\n    <path d="M10846 2159 c-68 -81 17 -194 110 -144 89 48 56 175 -46 175 -30 0\n      -44 -6 -64 -31z" />\n    <path d="M10670 2126 c-19 -23 -8 -61 18 -64 44 -7 67 32 36 62 -19 20 -38 20\n      -54 2z" />\n    <path d="M11106 2127 c-21 -16 -18 -45 7 -61 37 -23 77 35 41 61 -10 7 -21 13\n      -24 13 -3 0 -14 -6 -24 -13z" />\n    <path d="M10290 1970 c0 -29 43 -141 74 -195 l28 -48 116 116 c81 81 113 120\n      109 131 -6 14 -29 16 -167 16 -152 0 -160 -1 -160 -20z" />\n    <path d="M11207 1978 c-3 -7 47 -66 111 -130 l116 -118 27 43 c27 44 79 177\n      79 203 0 12 -28 14 -164 14 -122 0 -166 -3 -169 -12z" />\n    <path d="M10881 1901 c-14 -25 -5 -48 20 -56 27 -9 51 13 47 44 -4 34 -51 43\n      -67 12z" />\n    <path d="M10662 1697 c-61 -62 -112 -115 -112 -119 0 -20 201 -108 247 -108\n      10 0 13 34 13 164 0 140 -2 165 -16 170 -9 3 -16 6 -17 6 -1 0 -53 -51 -115\n      -113z" />\n    <path d="M11033 1803 c-10 -3 -13 -47 -13 -169 0 -90 4 -164 8 -164 36 0 186\n      61 239 98 16 10 -216 242 -234 235z" />\n  </g>\n  </svg>\n`,u=(n,t,e)=>`\n  <div class="garage__track-car" id ="track-car-${n}">\n  <div class="garage__car-controls">\n    <button class="garage__button garage__button-options button" id="button-select-${n}" type="button">Select</button>\n    <button class="garage__button garage__button-options button" id="button-remove-${n}" type="button">Remove</button>\n    <p class="garage__car-name" id="car-name-${n}">${t}</p>\n  </div>\n  <div class="garage__track-road">\n    <div class="garage__track-launch-pad">\n      <div class="engine-controls">\n        <button class="engine-button start-engine-button" id="start-engine-car-${n}">A</button>\n        <button class="engine-button stop-engine-button disabled" id="stop-engine-car-${n}" disabled>B</button>\n      </div>\n      <div class="garage__car" id="car-${n}">\n        ${s(e)}\n      </div>\n    </div>\n    <div class="garage__track-flag" id="flag-${n}">üèÅ</div>\n  </div>\n  </div>\n`;var l=function(n,t,e,o){return new(e||(e=Promise))((function(a,r){function i(n){try{d(o.next(n))}catch(n){r(n)}}function c(n){try{d(o.throw(n))}catch(n){r(n)}}function d(n){var t;n.done?a(n.value):(t=n.value,t instanceof e?t:new e((function(n){n(t)}))).then(i,c)}d((o=o.apply(n,t||[])).next())}))};const v=(e=1)=>l(void 0,void 0,void 0,(function*(){const a=yield((n=1,e=7)=>t(void 0,void 0,void 0,(function*(){const t=`${o}?_page=${n}&_limit=${e}`;try{const n=yield fetch(t),e=yield n.json(),o=n.headers.get("X-Total-Count"),a=Number(o);if(200===n.status)return{cars:e,count:a}}catch(n){if(n instanceof Error)throw new Error(n.message)}return null})))(e);return n.carsOnPage=(null==a?void 0:a.cars)||[],{cars:null==a?void 0:a.cars.map((n=>u(n.id,n.name,n.color))),count:null==a?void 0:a.count}})),g=(e=1)=>l(void 0,void 0,void 0,(function*(){const a=yield d(e,n.sortBy,n.order),r=null==a?void 0:a.winners.map(((n,e)=>l(void 0,void 0,void 0,(function*(){const a=yield(r=n.id,t(void 0,void 0,void 0,(function*(){try{const n=yield fetch(`${o}/${r}`),t=yield n.json();if(200===n.status)return t}catch(n){if(n instanceof Error)throw new Error(n.message)}return null})));var r;const i=(null==a?void 0:a.color)?null==a?void 0:a.color:"#ffffff",c=s(i),d=(null==a?void 0:a.name)?null==a?void 0:a.name:"Tesla Model S";return((n,t,e,o,a,r)=>`\n  <tr id="winner-${r}">\n    <td class="winners__table-cell">${n}</td>\n    <td class="winners__table-cell">${t}</td>\n    <td class="winners__table-cell">${e}</td>\n    <td class="winners__table-cell">${o}</td>\n    <td class="winners__table-cell">${a} sec</td>\n  </tr>\n`)(e+1,c,d,n.wins,n.time,n.id)}))));let i=[];return r&&(i=yield Promise.all(r)),{winners:i,count:null==a?void 0:a.count}}));var m={raceButton:null,resetButton:null,generateButton:null,root:null,sortByWinsButton:null,sortByTimeButton:null,createButton:null,createModelInput:null,createColorInput:null,carsCounter:null,updateButton:null,updateModelInput:null,updateColorInput:null,garageButton:null,winnersButton:null,garagePage:null,winnersPage:null,previousPageButton:null,nextPageButton:null,carsContainer:null,garagePagesCounter:null,winnersContainer:null,winnersPageCounter:null,winnersTotalCount:null};const p=n=>Math.floor(Math.random()*n.length),f=n=>{null==n||n.classList.add("disabled"),null==n||n.setAttribute("disabled","")},y=n=>{null==n||n.classList.remove("disabled"),null==n||n.removeAttribute("disabled")},h=(n,t)=>{t?f(n):y(n)};var b=function(n,t,e,o){return new(e||(e=Promise))((function(a,r){function i(n){try{d(o.next(n))}catch(n){r(n)}}function c(n){try{d(o.throw(n))}catch(n){r(n)}}function d(n){var t;n.done?a(n.value):(t=n.value,t instanceof e?t:new e((function(n){n(t)}))).then(i,c)}d((o=o.apply(n,t||[])).next())}))};const w=()=>{var t,e;const o=!(null===(t=m.previousPageButton)||void 0===t?void 0:t.hasAttribute("disabled")),a=!(null===(e=m.nextPageButton)||void 0===e?void 0:e.hasAttribute("disabled"));n.paginationButtonsState.prevIsActive=o,n.paginationButtonsState.nextIsActive=a},B=()=>{const t="garage"===n.currentPage,e=t?n.carsInGarage:n.winnersAtAll,o=t?n.carsPerPageLimit:n.winnersPerPageLimit,a=t?n.currentGaragePage:n.currentWinnersPage,r=Math.ceil(e/o);1===a?(h(m.previousPageButton,!0),h(m.nextPageButton,e<=o)):(h(m.previousPageButton,!1),h(m.nextPageButton,!(a<r))),w(),n.isRace&&t&&(h(m.previousPageButton,!0),h(m.nextPageButton,!0))},I=t=>b(void 0,void 0,void 0,(function*(){var e;"garage"===n.currentPage&&m.carsContainer&&(yield(e=t,b(void 0,void 0,void 0,(function*(){e?n.currentGaragePage+=1:n.currentGaragePage-=1;const{cars:t}=yield v(n.currentGaragePage);m.carsContainer&&t&&(m.carsContainer.innerHTML=null==t?void 0:t.join(""))}))),m.garagePagesCounter&&(m.garagePagesCounter.innerHTML=`${n.currentGaragePage}`)),"winners"===n.currentPage&&(yield(t=>b(void 0,void 0,void 0,(function*(){t?n.currentWinnersPage+=1:n.currentWinnersPage-=1;const{winners:e}=yield g(n.currentWinnersPage);m.winnersContainer&&e&&(m.winnersContainer.innerHTML=null==e?void 0:e.join(""))})))(t),m.winnersPageCounter&&(m.winnersPageCounter.innerHTML=`${n.currentWinnersPage}`)),B()}));var P=function(n,t,e,o){return new(e||(e=Promise))((function(a,r){function i(n){try{d(o.next(n))}catch(n){r(n)}}function c(n){try{d(o.throw(n))}catch(n){r(n)}}function d(n){var t;n.done?a(n.value):(t=n.value,t instanceof e?t:new e((function(n){n(t)}))).then(i,c)}d((o=o.apply(n,t||[])).next())}))};const E=(n,t)=>{n instanceof HTMLInputElement&&(n.value||f(t),n.value&&y(t))},_=(n,t)=>{n.addEventListener("focus",(()=>E(n,t))),n.addEventListener("input",(()=>E(n,t))),n.addEventListener("focusout",(()=>E(n,t))),t.addEventListener("click",(()=>f(t)))},M=(e,a,r)=>P(void 0,void 0,void 0,(function*(){const i=yield((n,e)=>P(void 0,void 0,void 0,(function*(){const a=yield(r={name:n,color:e},t(void 0,void 0,void 0,(function*(){try{const n=yield fetch(o,{method:"POST",body:JSON.stringify(r),headers:{"Content-Type":"application/json"}}),t=yield n.json();if(201===n.status)return t}catch(n){if(n instanceof Error)throw new Error(n.message)}return null})));var r;return{carName:null==a?void 0:a.name,carColor:null==a?void 0:a.color,id:null==a?void 0:a.id}})))(e,a),{id:c,carName:d,carColor:s}=i;let l="";c&&d&&s&&n.carsInGarage<r&&(l=u(c,d,s),n.carsOnPage.push({name:e,color:a,id:c})),m.carsContainer&&n.carsInGarage<r&&(m.carsContainer.innerHTML+=l),m.carsCounter&&(m.carsCounter.innerText=`${n.carsInGarage+=1}`)})),C=(n=!1)=>{const t=[m.updateModelInput,m.updateColorInput];n?(t.forEach((n=>{f(n)})),m.updateModelInput instanceof HTMLInputElement&&(m.updateModelInput.value=""),m.updateButton&&f(m.updateButton)):(t.forEach((n=>{y(n)})),m.updateModelInput&&m.updateButton&&_(m.updateModelInput,m.updateButton))},$=()=>P(void 0,void 0,void 0,(function*(){var e,a,i;n.currentGaragePage=Number(null===(e=m.garagePagesCounter)||void 0===e?void 0:e.innerHTML),n.currentWinnersPage=Number(null===(a=m.winnersPageCounter)||void 0===a?void 0:a.innerHTML);const c=yield d(n.currentWinnersPage,n.sortBy,n.order),s=null==c?void 0:c.winners.map((n=>n.id)),u=null==s?void 0:s.includes(n.selectedCarId),l=document.getElementById(`track-car-${n.selectedCarId}`);var p,f,y;if(n.carsInGarage=Number(null===(i=m.carsCounter)||void 0===i?void 0:i.innerHTML),yield(p=n.selectedCarId,t(void 0,void 0,void 0,(function*(){try{yield fetch(`${o}/${p}`,{method:"DELETE"})}catch(n){if(n instanceof Error)throw new Error(n.message)}}))),yield(f=n.currentWinnersPage,y=!!u,P(void 0,void 0,void 0,(function*(){var e;if(yield(e=n.selectedCarId,t(void 0,void 0,void 0,(function*(){try{yield fetch(`${r}/${e}`,{method:"DELETE"})}catch(n){if(n instanceof Error)throw new Error(n.message)}}))),!y)return;const{winners:o,count:a}=yield g(f);n.winnersAtAll=a||0,m.winnersTotalCount&&(m.winnersTotalCount.innerHTML=`${n.winnersAtAll}`),m.winnersContainer&&(m.winnersContainer.innerHTML=o.join(""))}))),l&&l.remove(),m.carsCounter&&(m.carsCounter.innerText=""+(n.carsInGarage-=1)),n.carsInGarage>=n.carsPerPageLimit){const{cars:t}=yield v(n.currentGaragePage);m.carsContainer&&t&&(m.carsContainer.innerHTML=null==t?void 0:t.join(""))}C(!0),B()})),L=()=>{var e,a;null===(e=m.updateButton)||void 0===e||e.addEventListener("click",(()=>P(void 0,void 0,void 0,(function*(){var e;let a="",r="";var i,c;m.updateModelInput instanceof HTMLInputElement&&(a=m.updateModelInput.value,m.updateModelInput.value=""),m.updateColorInput instanceof HTMLInputElement&&(r=null===(e=m.updateColorInput)||void 0===e?void 0:e.value),yield(i=n.selectedCarId,c={name:a,color:r},t(void 0,void 0,void 0,(function*(){try{yield fetch(`${o}/${i}`,{method:"PUT",body:JSON.stringify(c),headers:{"Content-Type":"application/json"}})}catch(n){if(n instanceof Error)throw new Error(n.message)}})));const d=document.getElementById(`car-name-${n.selectedCarId}`),u=document.getElementById(`car-${n.selectedCarId}`);d&&(d.textContent=a),u&&(u.innerHTML=s(r)),((t,e)=>{const o=document.getElementById(`winner-${n.selectedCarId}`);o&&(o.children[1].innerHTML=s(e),o.children[2].innerHTML=t)})(a,r)})))),null===(a=m.carsContainer)||void 0===a||a.addEventListener("click",(t=>{const{target:e}=t;let o="";e instanceof HTMLButtonElement&&(o=e.id,n.selectedCarId=Number(o.slice(o.lastIndexOf("-")+1))),o.match("button-select")&&e instanceof HTMLElement&&(e.classList.contains("active")?(e.classList.remove("active"),C(!0),n.selectedCarId=0):(document.querySelectorAll(".garage__button-options").forEach((n=>n.classList.remove("active"))),e.classList.add("active"),C())),o.match("button-remove")&&$()}))};var T=function(n,t,e,o){return new(e||(e=Promise))((function(a,r){function i(n){try{d(o.next(n))}catch(n){r(n)}}function c(n){try{d(o.throw(n))}catch(n){r(n)}}function d(n){var t;n.done?a(n.value):(t=n.value,t instanceof e?t:new e((function(n){n(t)}))).then(i,c)}d((o=o.apply(n,t||[])).next())}))};const A=()=>T(void 0,void 0,void 0,(function*(){const{winners:t,count:e}=yield g(n.currentWinnersPage);n.winnersAtAll=e||0,m.winnersTotalCount&&(m.winnersTotalCount.innerHTML=`${n.winnersAtAll}`),m.winnersContainer&&t&&(m.winnersContainer.innerHTML=null==t?void 0:t.join("")),B()}));var x=function(n,t,e,o){return new(e||(e=Promise))((function(a,r){function i(n){try{d(o.next(n))}catch(n){r(n)}}function c(n){try{d(o.throw(n))}catch(n){r(n)}}function d(n){var t;n.done?a(n.value):(t=n.value,t instanceof e?t:new e((function(n){n(t)}))).then(i,c)}d((o=o.apply(n,t||[])).next())}))};const H=(n,t,e)=>{const o=t?document.getElementById(`stop-engine-car-${e}`):document.getElementById(`start-engine-car-${e}`),a=document.getElementById(`button-remove-${e}`);t?f(a):y(a),f(n),y(o)},z=n=>x(void 0,void 0,void 0,(function*(){const e=yield(n=>t(void 0,void 0,void 0,(function*(){try{const t=yield fetch(`${a}?id=${n}&status=started`,{method:"PATCH"}),e=yield t.json();if(200===t.status)return e}catch(n){if(n instanceof Error)throw new Error(n.message)}return null})))(n);return{velocity:null==e?void 0:e.velocity,distance:null==e?void 0:e.distance}})),k=(e,o,a)=>{const i=a,c=document.getElementById(`flag-${o}`),d=null==i?void 0:i.offsetLeft,s=null==c?void 0:c.offsetLeft,u=null==c?void 0:c.clientWidth,l=performance.now(),v=a=>x(void 0,void 0,void 0,(function*(){let c=Math.pow((a-l)/e,2),g=0;c>1&&(c=1),s&&d&&u&&(g=s+u-d);const m=c*g;i&&(i.style.transform=`translateX(${m}px)`),c<1?n.carsAnimationId[`${o}`]=window.requestAnimationFrame(v):!n.raceWinnerId&&n.isRace&&(((t,e)=>{n.raceWinnerId=t;const o=document.getElementById(`car-name-${t}`),a=+(e/1e3).toFixed(2),r=((n,t)=>{const e=document.getElementById("body"),o=((n,t)=>{const e=document.createElement("div");return e.classList.add("winning-message"),e.id="winning-message",e.innerHTML=`<p class="winning-message-content">${n} finished first in ${t} sec</p>`,e})(n,t);return null==e||e.append(o),o})((null==o?void 0:o.innerText)||"",a);window.addEventListener("click",(()=>r.remove()))})(o,e),yield((n,e)=>T(void 0,void 0,void 0,(function*(){const o=yield(n=>t(void 0,void 0,void 0,(function*(){try{const t=yield fetch(`${r}/${n}`),e=yield t.json();if(200===t.status)return e}catch(n){if(n instanceof Error)throw new Error(n.message)}return null})))(n),a=+(e/1e3).toFixed(2);if(o){const e={wins:o.wins+=1,time:Math.min(o.time,a)};yield((n,e)=>t(void 0,void 0,void 0,(function*(){try{yield fetch(`${r}/${n}`,{method:"PUT",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}})}catch(n){if(n instanceof Error)throw new Error(n.message)}})))(n,e)}else{const e={wins:1,time:a,id:n};yield(n=>t(void 0,void 0,void 0,(function*(){try{yield fetch(r,{method:"POST",body:JSON.stringify(n),headers:{"Content-Type":"application/json"}})}catch(n){if(n instanceof Error)throw new Error(n.message)}})))(e)}yield A()})))(o,e))}));n.carsAnimationId[`${o}`]=window.requestAnimationFrame(v)};var G=function(n,t,e,o){return new(e||(e=Promise))((function(a,r){function i(n){try{d(o.next(n))}catch(n){r(n)}}function c(n){try{d(o.throw(n))}catch(n){r(n)}}function d(n){var t;n.done?a(n.value):(t=n.value,t instanceof e?t:new e((function(n){n(t)}))).then(i,c)}d((o=o.apply(n,t||[])).next())}))};const S=(n,t)=>{var e,o,a;h(n,!1),h(t,!0),null===(e=m.generateButton)||void 0===e||e.classList.toggle("disabled"),(null===(o=m.generateButton)||void 0===o?void 0:o.hasAttribute("disabled"))?m.generateButton.removeAttribute("disabled"):null===(a=m.generateButton)||void 0===a||a.setAttribute("disabled","")},O=()=>G(void 0,void 0,void 0,(function*(){const t=[];n.isRace=!1,n.carsOnPage.forEach((n=>t.push(i(n.id)))),yield Promise.all(t),n.carsOnPage.forEach((t=>{const e=document.getElementById(`car-${t.id}`),o=document.getElementById(`stop-engine-car-${t.id}`);o&&H(o,!1,t.id),window.cancelAnimationFrame(n.carsAnimationId[`${t.id}`]),e&&(e.style.transform="translateX(0px)")}))})),N=()=>{n.carsOnPage.map((n=>n.id)).forEach((n=>{const t=document.getElementById(`start-engine-car-${n}`);t&&H(t,!0,n)}))};var W,j;j=function*(){var t;yield((t=1)=>l(void 0,void 0,void 0,(function*(){const e=yield(t=>l(void 0,void 0,void 0,(function*(){const{cars:e,count:o}=yield v(t),a=((n,t,e=1)=>`\n  <div class="garage__track">\n    <h1 class="garage__track-title">Garage &nbsp;<span id="garage-cars-count">${n}</span></h1>\n    <h2 class="garage__track-subtitle">Page &nbsp; <span id="garage-page-count">${e}</span></h2>\n    <div class="garage__track-cars" id="cars">\n      ${t.join("")}\n    </div>\n  </div>\n`)(o||0,e||[],t),r=(n=>`\n<div class="garage" id="garage">\n  \n  <div class="garage__menu">\n    <form class="garage__form" id="create">\n      <input class="garage__input" id="create-model" name="model" type="text">\n      <input class="garage__input" id="create-color" name="color" type="color">\n      <button class="garage__button button disabled" id="button-create" type="submit" disabled>Create</button>\n    </form>\n    <form class="garage__form" id="update">\n      <input class="garage__input disabled" id="update-model" name="model" type="text" disabled>\n      <input class="garage__input disabled" id="update-color" name="color" type="color" disabled>\n      <button class="garage__button button disabled" id="button-update" type="submit" disabled>Update</button>\n    </form>\n    <div class="garage__controls">\n      <button class="garage__button garage__button-controls button" id="button-race" type="button">Race</button>\n      <button class="garage__button garage__button-controls button disabled" id="button-reset" type="button"\n        disabled>Reset</button>\n      <button class="garage__button garage__button-controls button" id="button-generate"\n        type="button">Generate</button>\n    </div>\n  </div>\n\n  ${n}\n</div>\n`)(a);return n.carsInGarage=o||0,r})))(t),o=yield(t=>l(void 0,void 0,void 0,(function*(){const{winners:e,count:o}=yield g(t),a=((n,t,e=1)=>`\n  <div class="winners" id="winners">\n    <h1 class="winners__title">Winners &nbsp;<span id="winners-total-count">${t}</span></h1>\n    <h2 class="winners__subtitle">Page &nbsp; <span id="winners-page-count">${e}</span></h2>\n    <table class="winners__table">\n      <thead>\n        <tr>\n          <th class="winners__table-header-cell">Number</th>\n          <th class="winners__table-header-cell">Car</th>\n          <th class="winners__table-header-cell">Name</th>\n          <th class="winners__table-button winners__table-header-cell" id="sort-by-wins">Wins</th>\n          <th class="winners__table-button winners__table-header-cell" id="sort-by-time">Best time</th>\n        </tr>\n      </thead>\n      <tbody id="winning-cars">\n      ${n.join("")}\n      </tbody>\n    </table>\n  </div>\n`)(e||[],o||0,t);return n.winnersAtAll=o||0,a})))(t);((n,t)=>{const e=document.getElementById("body"),o='\n  <div class="menu">\n    <button class="menu__button button active" id="button-garage">Garage</button>\n    <button class="menu__button button" id="button-winners">Leaderboard</button>\n  </div>\n'.concat(n,t,'\n  <div class="pagination">\n    <button class="pagination__button button" id="button-prev" type="button">Prev</button>\n    <button class="pagination__button button" id="button-next" type="button">Next</button>\n  </div>\n');e&&(e.innerHTML=o)})(e,o)})))(1),m.raceButton=document.getElementById("button-race"),m.resetButton=document.getElementById("button-reset"),m.root=document.getElementById("body"),m.sortByWinsButton=document.getElementById("sort-by-wins"),m.sortByTimeButton=document.getElementById("sort-by-time"),m.createButton=document.getElementById("button-create"),m.createModelInput=document.getElementById("create-model"),m.createColorInput=document.getElementById("create-color"),m.carsCounter=document.getElementById("garage-cars-count"),m.updateButton=document.getElementById("button-update"),m.updateModelInput=document.getElementById("update-model"),m.updateColorInput=document.getElementById("update-color"),m.generateButton=document.getElementById("button-generate"),m.garageButton=document.getElementById("button-garage"),m.winnersButton=document.getElementById("button-winners"),m.garagePage=document.getElementById("garage"),m.winnersPage=document.getElementById("winners"),m.previousPageButton=document.getElementById("button-prev"),m.nextPageButton=document.getElementById("button-next"),m.carsContainer=document.getElementById("cars"),m.garagePagesCounter=document.getElementById("garage-page-count"),m.winnersPageCounter=document.getElementById("winners-page-count"),m.winnersContainer=document.getElementById("winning-cars"),m.winnersTotalCount=document.getElementById("winners-total-count"),(()=>{var t,e;null===(t=m.garageButton)||void 0===t||t.addEventListener("click",(()=>{var t,e;m.garagePage&&(m.garagePage.style.display="block"),m.winnersPage&&(m.winnersPage.style.display="none"),null===(t=m.garageButton)||void 0===t||t.classList.add("active"),null===(e=m.winnersButton)||void 0===e||e.classList.remove("active"),n.currentPage="garage",B()})),null===(e=m.winnersButton)||void 0===e||e.addEventListener("click",(()=>{var t,e;m.winnersPage&&(m.winnersPage.style.display="block"),m.garagePage&&(m.garagePage.style.display="none"),null===(t=m.winnersButton)||void 0===t||t.classList.add("active"),null===(e=m.garageButton)||void 0===e||e.classList.remove("active"),n.currentPage="winners",B()}))})(),(()=>{var t;m.createModelInput&&m.createButton&&_(m.createModelInput,m.createButton),null===(t=m.createButton)||void 0===t||t.addEventListener("click",(t=>(t=>P(void 0,void 0,void 0,(function*(){var e,o,a;t.preventDefault(),n.carsInGarage=Number(null===(e=m.carsCounter)||void 0===e?void 0:e.innerHTML);const r=Number(null===(o=m.garagePagesCounter)||void 0===o?void 0:o.innerHTML),i=n.carsPerPageLimit*r;let c="",d="";m.createModelInput instanceof HTMLInputElement&&(c=m.createModelInput.value,m.createModelInput.value=""),m.createColorInput instanceof HTMLInputElement&&(d=null===(a=m.createColorInput)||void 0===a?void 0:a.value),yield M(c,d,i),B()})))(t)))})(),w(),L(),null===(t=m.generateButton)||void 0===t||t.addEventListener("click",(()=>P(void 0,void 0,void 0,(function*(){var t,e;n.carsInGarage=Number(null===(t=m.carsCounter)||void 0===t?void 0:t.innerHTML);const o=Number(null===(e=m.garagePagesCounter)||void 0===e?void 0:e.innerHTML),a=n.carsPerPageLimit*o,r=[],i=[];for(let t=0;t<100;t+=1)r.push(`${n.carsBrands[p(n.carsBrands)]} ${n.carsModels[p(n.carsModels)]}`);r.forEach((n=>{const t=(()=>{const n="0123456789ABCDEF";let t="#";for(let e=0;e<6;e+=1)t+=n[p(n)];return t})();i.push(M(n,t,a))})),yield Promise.all(i),B()})))),(()=>{var n,t;null===(n=m.previousPageButton)||void 0===n||n.addEventListener("click",(()=>b(void 0,void 0,void 0,(function*(){yield I(!1)})))),null===(t=m.nextPageButton)||void 0===t||t.addEventListener("click",(()=>b(void 0,void 0,void 0,(function*(){yield I(!0)}))))})(),B(),(()=>{var t;null===(t=m.carsContainer)||void 0===t||t.addEventListener("click",(t=>x(void 0,void 0,void 0,(function*(){const{target:e}=t;let o="",a=0;if(!(e instanceof HTMLButtonElement))return;o=e.id,a=Number(o.slice(o.lastIndexOf("-")+1));const r=document.getElementById(`car-${a}`);if(r){if(o.match("start-engine-car")){n.isRace=!1,H(e,!0,a);const{velocity:t,distance:o}=yield z(a);k((o||0)/(t||0),a,r);const i=yield c(a);(null==i?void 0:i.success)||window.cancelAnimationFrame(n.carsAnimationId[`${a}`])}o.match("stop-engine-car")&&(yield i(a),H(e,!1,a),window.cancelAnimationFrame(n.carsAnimationId[`${a}`]),r.style.transform="translateX(0px)")}}))))})(),(()=>{var t;null===(t=m.raceButton)||void 0===t||t.addEventListener("click",(()=>G(void 0,void 0,void 0,(function*(){m.resetButton&&(m.raceButton&&(S(m.resetButton,m.raceButton),h(m.resetButton,!0)),m.createButton&&h(m.createButton,!0),m.createModelInput&&f(m.createModelInput),m.previousPageButton&&m.nextPageButton&&(f(m.previousPageButton),f(m.nextPageButton)),N(),yield G(void 0,void 0,void 0,(function*(){yield O(),N(),n.isRace=!0,n.raceWinnerId=0;const t=[];n.carsOnPage.forEach((n=>t.push(z(n.id)))),yield Promise.all(t);const e=t.map((n=>G(void 0,void 0,void 0,(function*(){const{velocity:t,distance:e}=yield n;return(e||0)/(t||0)}))));n.carsOnPage.forEach(((t,o)=>G(void 0,void 0,void 0,(function*(){const a=document.getElementById(`car-${t.id}`),r=yield e[o];a&&k(r,t.id,a);const i=yield c(t.id);(null==i?void 0:i.success)||window.cancelAnimationFrame(n.carsAnimationId[`${t.id}`])}))))})),h(m.resetButton,!1))}))))})(),(()=>{var t;null===(t=m.resetButton)||void 0===t||t.addEventListener("click",(()=>G(void 0,void 0,void 0,(function*(){yield O(),m.createModelInput instanceof HTMLInputElement&&(m.resetButton&&m.raceButton&&S(m.raceButton,m.resetButton),n.paginationButtonsState.prevIsActive&&m.previousPageButton&&y(m.previousPageButton),n.paginationButtonsState.nextIsActive&&m.nextPageButton&&y(m.nextPageButton),m.createButton&&m.createModelInput.value&&h(m.createButton,!1),y(m.createModelInput))}))))})(),(()=>{var t,e;null===(t=m.sortByWinsButton)||void 0===t||t.addEventListener("click",(()=>T(void 0,void 0,void 0,(function*(){n.sortBy="wins",n.winsOrder="ASC"===n.winsOrder?"DESC":"ASC",n.order=n.winsOrder,yield A()})))),null===(e=m.sortByTimeButton)||void 0===e||e.addEventListener("click",(()=>T(void 0,void 0,void 0,(function*(){n.sortBy="time",n.timeOrder="ASC"===n.timeOrder?"DESC":"ASC",n.order=n.timeOrder,yield A()}))))})()},new((W=void 0)||(W=Promise))((function(n,t){function e(n){try{a(j.next(n))}catch(n){t(n)}}function o(n){try{a(j.throw(n))}catch(n){t(n)}}function a(t){var a;t.done?n(t.value):(a=t.value,a instanceof W?a:new W((function(n){n(a)}))).then(e,o)}a((j=j.apply(void 0,[])).next())}))}();
//# sourceMappingURL=main.76919bac6962588d632a.js.map